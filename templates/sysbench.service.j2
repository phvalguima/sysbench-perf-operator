[Unit]
Description=Service for controlling sysbench
Wants=network.target

[Service]
EnvironmentFile=-/etc/environment
ExecStartPre=/usr/bin/sysbench_svc.py --tpcc_script=/opt/tpcc.lua --db_driver={{ db_driver }} --threads={{ threads }} --tables={{ tables }}--scale={{ scale }} --db_name={{ db_name }} --db_user={{ db_user }} --db_password={{ db_password }} --db_host={{ db_host }} --db_port={{ db_port }} --duration={{ duration }} --command=prepare --extra_labels={{ extra-labels }} --duration={{ duration }}
ExecStart=/usr/bin/sysbench_svc.py --tpcc_script=/opt/tpcc.lua --db_driver={{ db_driver }} --threads={{ threads }} --tables={{ tables }}--scale={{ scale }} --db_name={{ db_name }} --db_user={{ db_user }} --db_password={{ db_password }} --db_host={{ db_host }} --db_port={{ db_port }} --duration={{ duration }} --command=run --extra_labels={{ extra-labels }} --duration={{ duration }}
Restart=always
ExecStop=/usr/bin/sysbench_svc.py --tpcc_script=/opt/tpcc.lua --db_driver={{ db_driver }} --threads={{ threads }} --tables={{ tables }}--scale={{ scale }} --db_name={{ db_name }} --db_user={{ db_user }} --db_password={{ db_password }} --db_host={{ db_host }} --db_port={{ db_port }} --duration={{ duration }} --command=clean --extra_labels={{ extra-labels }} --duration={{ duration }}
TimeoutSec=600
Type=simple
